<!DOCTYPE HTML>
<html lang="en" >
    <head><meta charset="UTF-8">
<meta content="text/html; charset=utf-8" http-equiv="Content-Type">
<meta name="google-site-verification" content="MrJpPCJ8htzZlGpC1wo97QA1_XWns05Ez0LBsW3wj3I" /><title>OS | Virtual Memory Â· Home</title><meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="description" content="Build Jekyll site with the GitBook style.
"><meta name="generator" content="Jekyll (using style of GitBook 3.2.3)"><meta name="author" content="Benson Hsu"><link rel="stylesheet" href="/assets/gitbook/style.css">
<link rel="stylesheet" href="/assets/gitbook/gitbook-plugin-back-to-top-button/plugin.css">
<link rel="stylesheet" href="/assets/gitbook/gitbook-plugin-expandable-chapters-small2/expandable-chapters-small.css">
<link rel="stylesheet" href="/assets/gitbook/gitbook-plugin-fontsettings/website.css">
<link rel="stylesheet" href="/assets/gitbook/gitbook-plugin-search-pro/search.css">
<link rel="stylesheet" href="/assets/gitbook/gitbook-plugin-splitter/splitter.css">

<link rel="stylesheet" href="/assets/gitbook/rouge/colorful.css">

<link rel="stylesheet" href="/assets/gitbook/custom.css">
<link rel="stylesheet" href="/assets/gitbook/custom-local.css">

<meta name="HandheldFriendly" content="true"/>
<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black">
<link rel="apple-touch-icon-precomposed" sizes="152x152" href="/assets/gitbook/images/apple-touch-icon-precomposed-152.png">
<link rel="shortcut icon" href="/assets/gitbook/images/favicon.ico" type="image/x-icon">




            <link rel="prev" href="/jekyll/2023-12-20-system_testing.html" />
        

        
            <link rel="next" href="/jekylls/2023-12-26-code_generation.html" />
        
    </head>
    <body>
        <div class="book"><div class="book-summary">
    <script type="text/javascript">
        // Fixes the page links scroll problem on both desktop and mobile browsers
        function pageScrollToTop(element) {
            // both mobile and non-mobile
            $('div.body-inner').animate({scrollTop: 0});
            $(element).parent().find('li>ul>li').removeClass('active');
            return true;  // propagate
        }
        // Fixes the anchor links scroll problem on mobile browsers
        function mobilePageScrollToAnchor(element) {
            $(element).closest('li.chapter').find('ul>li').removeClass('active');
            $(element).parent().addClass('active');
            if ($(document).width() <= 1240) {
                $('div.body-inner').animate({scrollTop: $($(element).attr('href')).get(0).offsetTop});
            }
            return true;
        }
    </script>

    <nav role="navigation">
        <div id="book-search-input" role="search">
            <input type="text" placeholder="Type to search" />
        </div>
        <div id="book-search-input-link" role="search">
            <a href="/assets/search.html">Click to Search</a>
        </div>
        <ul class="summary">
            
            <li class="chapter" data-level="1.1" data-path="">
            
                <a href="/" onclick="pageScrollToTop(this)">
                    Home
                </a>
            </li>

            <li class="divider"></li>

            
                <!-- <p>pages</p> -->
                
                    

                    

                    
                
            
                <!-- <p>posts</p> -->
                
                    

                    
                        
                        <li class="chapter" data-level="1.1" data-path="/jekyll/2025-09-13-Big_Number_Multiplication.html">
                        
                            <a href="/jekyll/2025-09-13-Big_Number_Multiplication.html" onclick="pageScrollToTop(this)">
                                Algorithm | Big Number Multiplication
                            </a>
                            
                                
                            
                        </li>
                    
                        
                        <li class="chapter" data-level="1.1" data-path="/jekyll/2025-09-12-Binary_Search_Tricks_and_Hacks.html">
                        
                            <a href="/jekyll/2025-09-12-Binary_Search_Tricks_and_Hacks.html" onclick="pageScrollToTop(this)">
                                Algorithm | Binary Search Tricks and Hacks
                            </a>
                            
                                
                            
                        </li>
                    
                        
                        <li class="chapter" data-level="1.1" data-path="/jekyll/2024-10-17-KLEE_symbolic_execution.html">
                        
                            <a href="/jekyll/2024-10-17-KLEE_symbolic_execution.html" onclick="pageScrollToTop(this)">
                                Paper | KLEE: Introducing Symbolic Execution
                            </a>
                            
                                
                            
                        </li>
                    
                        
                        <li class="chapter" data-level="1.1" data-path="/jekyll/2024-07-28-parallel_and_distributed_systems_introduction.html">
                        
                            <a href="/jekyll/2024-07-28-parallel_and_distributed_systems_introduction.html" onclick="pageScrollToTop(this)">
                                PDS | Introduction of Parallel and Distributed Systems
                            </a>
                            
                                
                            
                        </li>
                    
                        
                        <li class="chapter" data-level="1.1" data-path="/jekylls/2024-06-21-competitive_paging_algorithm.html">
                        
                            <a href="/jekylls/2024-06-21-competitive_paging_algorithm.html" onclick="pageScrollToTop(this)">
                                Algorithm | Competitive Paging Algorithm
                            </a>
                            
                                
                            
                        </li>
                    
                        
                        <li class="chapter" data-level="1.1" data-path="/jekylls/2024-06-09-arch_user_repository.html">
                        
                            <a href="/jekylls/2024-06-09-arch_user_repository.html" onclick="pageScrollToTop(this)">
                                Note | Arch User Repository
                            </a>
                            
                                
                            
                        </li>
                    
                        
                        <li class="chapter" data-level="1.1" data-path="/jekylls/2024-04-09-hirschbergs_algorithm.html">
                        
                            <a href="/jekylls/2024-04-09-hirschbergs_algorithm.html" onclick="pageScrollToTop(this)">
                                Algorithm | Hirschberg&#39;s Algorithm
                            </a>
                            
                                
                            
                        </li>
                    
                        
                        <li class="chapter" data-level="1.1" data-path="/jekylls/2024-03-08-ANTLR_guide.html">
                        
                            <a href="/jekylls/2024-03-08-ANTLR_guide.html" onclick="pageScrollToTop(this)">
                                Compiler | ANTLR Guide
                            </a>
                            
                                
                            
                        </li>
                    
                        
                        <li class="chapter" data-level="1.1" data-path="/jekylls/2024-03-06-arch_linux_installation.html">
                        
                            <a href="/jekylls/2024-03-06-arch_linux_installation.html" onclick="pageScrollToTop(this)">
                                Note | Arch Linux Installation
                            </a>
                            
                                
                            
                        </li>
                    
                        
                        <li class="chapter" data-level="1.1" data-path="/jekylls/2024-03-01-maven_multi_module_project.html">
                        
                            <a href="/jekylls/2024-03-01-maven_multi_module_project.html" onclick="pageScrollToTop(this)">
                                Note | Apache Maven Multi-Module Project Guide
                            </a>
                            
                                
                            
                        </li>
                    
                        
                        <li class="chapter" data-level="1.1" data-path="/jekyll/2024-02-03-storage_and_file_system.html">
                        
                            <a href="/jekyll/2024-02-03-storage_and_file_system.html" onclick="pageScrollToTop(this)">
                                OS | Storage and File System
                            </a>
                            
                                
                            
                        </li>
                    
                        
                        <li class="chapter" data-level="1.1" data-path="/jekylls/2024-01-05-debian_btrfs.html">
                        
                            <a href="/jekylls/2024-01-05-debian_btrfs.html" onclick="pageScrollToTop(this)">
                                Note | Using btrfs on Debian
                            </a>
                            
                                
                            
                        </li>
                    
                        
                        <li class="chapter" data-level="1.1" data-path="/jekylls/2023-12-26-code_generation.html">
                        
                            <a href="/jekylls/2023-12-26-code_generation.html" onclick="pageScrollToTop(this)">
                                Compiler | Code Generation (Unfinished)
                            </a>
                            
                                
                            
                        </li>
                    
                        
                        <li class="chapter active" data-level="1.2" data-path="/jekyll/2023-12-23-virtual_memory.html">
                        
                            <a href="/jekyll/2023-12-23-virtual_memory.html" onclick="pageScrollToTop(this)">
                                OS | Virtual Memory
                            </a>
                            
                                
                                    <ul><li><a href="#what-is-virtual-memory" onclick="mobilePageScrollToAnchor(this)" >What is Virtual Memory</a></li><li><a href="#virtual-memory-example" onclick="mobilePageScrollToAnchor(this)" >Virtual Memory Example</a></li><li><a href="#page-replacement" onclick="mobilePageScrollToAnchor(this)" >Page Replacement</a></li></ul>

                                
                            
                        </li>
                    
                        
                        <li class="chapter" data-level="1.1" data-path="/jekyll/2023-12-20-system_testing.html">
                        
                            <a href="/jekyll/2023-12-20-system_testing.html" onclick="pageScrollToTop(this)">
                                Testing | System Testing
                            </a>
                            
                                
                            
                        </li>
                    
                        
                        <li class="chapter" data-level="1.1" data-path="/jekyll/2023-12-12-mutation_testing.html">
                        
                            <a href="/jekyll/2023-12-12-mutation_testing.html" onclick="pageScrollToTop(this)">
                                Testing | Mutation Testing
                            </a>
                            
                                
                            
                        </li>
                    
                        
                        <li class="chapter" data-level="1.1" data-path="/jekyll/2023-12-10-main_memory.html">
                        
                            <a href="/jekyll/2023-12-10-main_memory.html" onclick="pageScrollToTop(this)">
                                OS | Main Memory
                            </a>
                            
                                
                            
                        </li>
                    
                        
                        <li class="chapter" data-level="1.1" data-path="/jekyll/2023-12-09-class_level_testing.html">
                        
                            <a href="/jekyll/2023-12-09-class_level_testing.html" onclick="pageScrollToTop(this)">
                                Testing | Class-Level Unit Testing
                            </a>
                            
                                
                            
                        </li>
                    
                        
                        <li class="chapter" data-level="1.1" data-path="/jekylls/2023-11-29-semantic_analysis.html">
                        
                            <a href="/jekylls/2023-11-29-semantic_analysis.html" onclick="pageScrollToTop(this)">
                                Compiler | Semantic Analysis Notes
                            </a>
                            
                                
                            
                        </li>
                    
                        
                        <li class="chapter" data-level="1.1" data-path="/jekyll/2023-11-28-test_coverage_criteria.html">
                        
                            <a href="/jekyll/2023-11-28-test_coverage_criteria.html" onclick="pageScrollToTop(this)">
                                Note | Test Coverage Criteria
                            </a>
                            
                                
                            
                        </li>
                    
                        
                        <li class="chapter" data-level="1.1" data-path="/jekyll/2023-11-25-method_level_structural_unit_testing.html">
                        
                            <a href="/jekyll/2023-11-25-method_level_structural_unit_testing.html" onclick="pageScrollToTop(this)">
                                Testing | Method-Level Structural Unit Testing
                            </a>
                            
                                
                            
                        </li>
                    
                        
                        <li class="chapter" data-level="1.1" data-path="/jekyll/2023-11-24-deadlock.html">
                        
                            <a href="/jekyll/2023-11-24-deadlock.html" onclick="pageScrollToTop(this)">
                                OS | Deadlock
                            </a>
                            
                                
                            
                        </li>
                    
                        
                        <li class="chapter" data-level="1.1" data-path="/jekyll/2023-11-23-based_on_clp_testcases.html">
                        
                            <a href="/jekyll/2023-11-23-based_on_clp_testcases.html" onclick="pageScrollToTop(this)">
                                Testing | Based on CLP Testcases
                            </a>
                            
                                
                            
                        </li>
                    
                        
                        <li class="chapter" data-level="1.1" data-path="/jekyll/2023-11-09-synchronization.html">
                        
                            <a href="/jekyll/2023-11-09-synchronization.html" onclick="pageScrollToTop(this)">
                                OS | Synchronization (Unfinished)
                            </a>
                            
                                
                            
                        </li>
                    
                        
                        <li class="chapter" data-level="1.1" data-path="/jekyll/2023-10-28-method_level_function_unit_testing.html">
                        
                            <a href="/jekyll/2023-10-28-method_level_function_unit_testing.html" onclick="pageScrollToTop(this)">
                                Testing | Method-Level Functional Unit Testing
                            </a>
                            
                                
                            
                        </li>
                    
                        
                        <li class="chapter" data-level="1.1" data-path="/jekylls/2023-10-26-syntax_analysis.html">
                        
                            <a href="/jekylls/2023-10-26-syntax_analysis.html" onclick="pageScrollToTop(this)">
                                Compiler | Syntax Analysis Notes
                            </a>
                            
                                
                            
                        </li>
                    
                        
                        <li class="chapter" data-level="1.1" data-path="/jekyll/2023-10-19-cpu_scheduler.html">
                        
                            <a href="/jekyll/2023-10-19-cpu_scheduler.html" onclick="pageScrollToTop(this)">
                                OS | CPU Scheduler
                            </a>
                            
                                
                            
                        </li>
                    
                        
                        <li class="chapter" data-level="1.1" data-path="/jekyll/2023-10-18-process_thread.html">
                        
                            <a href="/jekyll/2023-10-18-process_thread.html" onclick="pageScrollToTop(this)">
                                OS | Process and Thread
                            </a>
                            
                                
                            
                        </li>
                    
                        
                        <li class="chapter" data-level="1.1" data-path="/jekyll/2023-10-17-container_of.html">
                        
                            <a href="/jekyll/2023-10-17-container_of.html" onclick="pageScrollToTop(this)">
                                Note | Linux Kernel Macro container_of &amp; offsetof
                            </a>
                            
                                
                            
                        </li>
                    
                        
                        <li class="chapter" data-level="1.1" data-path="/jekyll/2023-10-10-test_case_generation.html">
                        
                            <a href="/jekyll/2023-10-10-test_case_generation.html" onclick="pageScrollToTop(this)">
                                Testing | Test Case Generation
                            </a>
                            
                                
                            
                        </li>
                    
                        
                        <li class="chapter" data-level="1.1" data-path="/jekyll/2023-10-09-operating_system_structure.html">
                        
                            <a href="/jekyll/2023-10-09-operating_system_structure.html" onclick="pageScrollToTop(this)">
                                OS | Operating System Structure
                            </a>
                            
                                
                            
                        </li>
                    
                        
                        <li class="chapter" data-level="1.1" data-path="/jekyll/2023-09-23-software_testing_introduction.html">
                        
                            <a href="/jekyll/2023-09-23-software_testing_introduction.html" onclick="pageScrollToTop(this)">
                                Testing | Software Testing Introduction
                            </a>
                            
                                
                            
                        </li>
                    
                        
                        <li class="chapter" data-level="1.1" data-path="/jekylls/2023-09-21-lexical_analysis.html">
                        
                            <a href="/jekylls/2023-09-21-lexical_analysis.html" onclick="pageScrollToTop(this)">
                                Compiler | Lexical Analysis Notes
                            </a>
                            
                                
                            
                        </li>
                    
                        
                        <li class="chapter" data-level="1.1" data-path="/jekyll/2023-09-20-compiler_introduction.html">
                        
                            <a href="/jekyll/2023-09-20-compiler_introduction.html" onclick="pageScrollToTop(this)">
                                Compiler | Compilers Introduction
                            </a>
                            
                                
                            
                        </li>
                    
                        
                        <li class="chapter" data-level="1.1" data-path="/jekyll/2023-09-12-operating_system_introduction.html">
                        
                            <a href="/jekyll/2023-09-12-operating_system_introduction.html" onclick="pageScrollToTop(this)">
                                OS | Operating System Introduction
                            </a>
                            
                                
                            
                        </li>
                    
                        
                        <li class="chapter" data-level="1.1" data-path="/jekyll/2023-09-07-test_case_generation_based_on_constraint_logic_graph.html">
                        
                            <a href="/jekyll/2023-09-07-test_case_generation_based_on_constraint_logic_graph.html" onclick="pageScrollToTop(this)">
                                Paper | Test Case Generation Based on Constraint Logic Graph
                            </a>
                            
                                
                            
                        </li>
                    
                        
                        <li class="chapter" data-level="1.1" data-path="/jekyll/2023-09-07-Introduction_OCL.html">
                        
                            <a href="/jekyll/2023-09-07-Introduction_OCL.html" onclick="pageScrollToTop(this)">
                                Note | Object Constraint Language Concepts (Unfinished)
                            </a>
                            
                                
                            
                        </li>
                    
                        
                        <li class="chapter" data-level="1.1" data-path="/jekyll/2023-08-06-gdb_introduction.html">
                        
                            <a href="/jekyll/2023-08-06-gdb_introduction.html" onclick="pageScrollToTop(this)">
                                Note | GNU Debugger Quick Notes
                            </a>
                            
                                
                            
                        </li>
                    
                        
                        <li class="chapter" data-level="1.1" data-path="/jekyll/2023-08-05-linux_kernel_complie.html">
                        
                            <a href="/jekyll/2023-08-05-linux_kernel_complie.html" onclick="pageScrollToTop(this)">
                                OS | Linux Kernel Compilation
                            </a>
                            
                                
                            
                        </li>
                    
                        
                        <li class="chapter" data-level="1.1" data-path="/jekyll/2023-07-28-UML_structure_diagrams.html">
                        
                            <a href="/jekyll/2023-07-28-UML_structure_diagrams.html" onclick="pageScrollToTop(this)">
                                Note | UML Structure Diagrams Introduction
                            </a>
                            
                                
                            
                        </li>
                    
                        
                        <li class="chapter" data-level="1.1" data-path="/jekyll/2023-07-28-UML_behavior_diagrams.html">
                        
                            <a href="/jekyll/2023-07-28-UML_behavior_diagrams.html" onclick="pageScrollToTop(this)">
                                Note | UML Behavior Diagrams Introduction (Unfinished)
                            </a>
                            
                                
                            
                        </li>
                    
                        
                        <li class="chapter" data-level="1.1" data-path="/jekyll/2023-07-26-unified_modeling_language.html">
                        
                            <a href="/jekyll/2023-07-26-unified_modeling_language.html" onclick="pageScrollToTop(this)">
                                Note | Unified Modeling Language Concepts
                            </a>
                            
                                
                            
                        </li>
                    
                        
                        <li class="chapter" data-level="1.1" data-path="/jekyll/2023-07-22-property_based_testing_entropy_guided_backbox_REST_API-_fuzzer.html">
                        
                            <a href="/jekyll/2023-07-22-property_based_testing_entropy_guided_backbox_REST_API-_fuzzer.html" onclick="pageScrollToTop(this)">
                                Paper | BenFuzz: A Property Based Testing and Entropy Guided Blackbox REST API Fuzzer
                            </a>
                            
                                
                            
                        </li>
                    
                        
                        <li class="chapter" data-level="1.1" data-path="/jekyll/2023-07-19-MVVM_modeling_methodology_user_interface.html">
                        
                            <a href="/jekyll/2023-07-19-MVVM_modeling_methodology_user_interface.html" onclick="pageScrollToTop(this)">
                                Paper | A MVVM Modeling Methodology for Information Systems User Interface Design
                            </a>
                            
                                
                            
                        </li>
                    
                        
                        <li class="chapter" data-level="1.1" data-path="/jekyll/2023-07-18-software_arch_pattern.html">
                        
                            <a href="/jekyll/2023-07-18-software_arch_pattern.html" onclick="pageScrollToTop(this)">
                                Note | Architectural Patterns Compare MVP, MVC, MVVM
                            </a>
                            
                                
                            
                        </li>
                    
                        
                        <li class="chapter" data-level="1.1" data-path="/jekyll/2023-07-18-automated_gen_test_case_using_UML.html">
                        
                            <a href="/jekyll/2023-07-18-automated_gen_test_case_using_UML.html" onclick="pageScrollToTop(this)">
                                Paper | Automated-generating test case using UML statechart diagrams (Unfinished)
                            </a>
                            
                                
                            
                        </li>
                    
                        
                        <li class="chapter" data-level="1.1" data-path="/jekyll/2023-06-23-Intergrated_environment_sdd.html">
                        
                            <a href="/jekyll/2023-06-23-Intergrated_environment_sdd.html" onclick="pageScrollToTop(this)">
                                Paper | An Integrated Environment for Specification Driven Development (Unfinished)
                            </a>
                            
                                
                            
                        </li>
                    
                        
                        <li class="chapter" data-level="1.1" data-path="/jekyll/2023-05-28-characteristics_of_bdd.html">
                        
                            <a href="/jekyll/2023-05-28-characteristics_of_bdd.html" onclick="pageScrollToTop(this)">
                                Paper | A Study of the Characteristics of Behaviour Driven Development
                            </a>
                            
                                
                            
                        </li>
                    
                        
                        <li class="chapter" data-level="1.1" data-path="/jekyll/2023-05-20-analysis_mutation_testing.html">
                        
                            <a href="/jekyll/2023-05-20-analysis_mutation_testing.html" onclick="pageScrollToTop(this)">
                                Paper | An Analysis and Survey of the Development of Mutation Testing
                            </a>
                            
                                
                            
                        </li>
                    
                        
                        <li class="chapter" data-level="1.1" data-path="/jekyll/2023-04-21-tdd_concepts.html">
                        
                            <a href="/jekyll/2023-04-21-tdd_concepts.html" onclick="pageScrollToTop(this)">
                                Paper | Test-driven development concepts, taxonomy, and future direction
                            </a>
                            
                                
                            
                        </li>
                    
                        
                        <li class="chapter" data-level="1.1" data-path="/jekyll/2023-04-18-applying_isoiec25010.html">
                        
                            <a href="/jekyll/2023-04-18-applying_isoiec25010.html" onclick="pageScrollToTop(this)">
                                Paper | Applying the ISO/IEC 25010 Quality Models to Software Product
                            </a>
                            
                                
                            
                        </li>
                    
                        
                        <li class="chapter" data-level="1.1" data-path="/jekyll/2023-04-13-software_standard.html">
                        
                            <a href="/jekyll/2023-04-13-software_standard.html" onclick="pageScrollToTop(this)">
                                Note | Standard - ISO/IEC
                            </a>
                            
                                
                            
                        </li>
                    
                        
                        <li class="chapter" data-level="1.1" data-path="/jekyll/2023-02-04-algorithm_kmp.html">
                        
                            <a href="/jekyll/2023-02-04-algorithm_kmp.html" onclick="pageScrollToTop(this)">
                                Leetcode | Algorithm - KMP
                            </a>
                            
                                
                            
                        </li>
                    
                        
                        <li class="chapter" data-level="1.1" data-path="/jekyll/2023-01-12-gomoku_ai.html">
                        
                            <a href="/jekyll/2023-01-12-gomoku_ai.html" onclick="pageScrollToTop(this)">
                                Note | Gomoku AI - Game Tree
                            </a>
                            
                                
                            
                        </li>
                    
                        
                        <li class="chapter" data-level="1.1" data-path="/jekyll/2022-11-24-git_commit.html">
                        
                            <a href="/jekyll/2022-11-24-git_commit.html" onclick="pageScrollToTop(this)">
                                Note | Commit Message Format
                            </a>
                            
                                
                            
                        </li>
                    
                        
                        <li class="chapter" data-level="1.1" data-path="/jekyll/2022-11-08-ai_csp.html">
                        
                            <a href="/jekyll/2022-11-08-ai_csp.html" onclick="pageScrollToTop(this)">
                                Note | Constraint Satisfaction Problem
                            </a>
                            
                                
                            
                        </li>
                    
                        
                        <li class="chapter" data-level="1.1" data-path="/jekyll/2022-11-07-network_urat.html">
                        
                            <a href="/jekyll/2022-11-07-network_urat.html" onclick="pageScrollToTop(this)">
                                Note | Basic UART Concept
                            </a>
                            
                                
                            
                        </li>
                    
                        
                        <li class="chapter" data-level="1.1" data-path="/jekyll/2022-11-05-docker_jekyll.html">
                        
                            <a href="/jekyll/2022-11-05-docker_jekyll.html" onclick="pageScrollToTop(this)">
                                Note | Docker Build Github Pages
                            </a>
                            
                                
                            
                        </li>
                    
                        
                        <li class="chapter" data-level="1.1" data-path="/jekyll/1970-01-01-virtual_machine_tool.html">
                        
                            <a href="/jekyll/1970-01-01-virtual_machine_tool.html" onclick="pageScrollToTop(this)">
                                Tool | Virtual Machine
                            </a>
                            
                                
                            
                        </li>
                    
                        
                        <li class="chapter" data-level="1.1" data-path="/jekyll/1970-01-01-linux_config.html">
                        
                            <a href="/jekyll/1970-01-01-linux_config.html" onclick="pageScrollToTop(this)">
                                Tool | Linux Config
                            </a>
                            
                                
                            
                        </li>
                    
                        
                        <li class="chapter" data-level="1.1" data-path="/jekyll/1970-01-01-leetcode_guide.html">
                        
                            <a href="/jekyll/1970-01-01-leetcode_guide.html" onclick="pageScrollToTop(this)">
                                Leetcode | Master Guide
                            </a>
                            
                                
                            
                        </li>
                    
                        
                        <li class="chapter" data-level="1.1" data-path="/jekyll/1970-01-01-editor_envirmnment.html">
                        
                            <a href="/jekyll/1970-01-01-editor_envirmnment.html" onclick="pageScrollToTop(this)">
                                Tool | Edirot Guide
                            </a>
                            
                                
                            
                        </li>
                    

                    
                        <li class="divider"></li>
                    
                
            
        </ul>
    </nav>
</div>
<div class="book-body">
                <div class="book-header" role="navigation">
                    <!-- Title -->
                    <h1>
                        <i class="fa fa-circle-o-notch fa-spin"></i>
                        
                            <a href="." >OS | Virtual Memory</a>
                        
                    </h1>
                </div>

                <div class="body-inner"><div class="page-wrapper" tabindex="-1" role="main">
    

    <div class="page-inner">
        <div class="normal">
            
            
            <section class="normal">December 23, 2023 </section>
            
        </div>
        <div id="book-search-results">
            <div class="search-noresults">
                <section class="normal markdown-section">
                    
                        <h1 id="/jekyll/virtual_memory">OS | Virtual Memory</h1>
                    

                    <blockquote class="block-tip">
  <p>Operating System: Design and Implementation course notes from CCU, lecturer Shiwu-Lo.</p>
</blockquote>

<p>æ¬ç« ç¯æä¸»è¦ä»ç´¹ Virtual Memory éæ¯éç« ç¯çè¨è«ç¯å</p>

<ul>
  <li>Virtual Memory Hardware and Software</li>
  <li>Virtual Memory Example</li>
  <li>Page Replacement</li>
  <li>Working Set</li>
  <li>open, read, writ vs. mmap
    <ul>
      <li>Differences between these system calls</li>
    </ul>
  </li>
  <li>TLB miss</li>
</ul>

<h5 id="mmu-main-function">MMU Main Function</h5>

<ul>
  <li>MMU ä¸»è¦èçè¨æ¶é«åéçåé¡
    <ul>
      <li>æ¶é¤äº External fragmentation(å¤é¨ç¢ç)</li>
      <li>ç±æ¼ Page size åæ 4KBï¼æä»¥ Internal fragmentation(å§é¨ç¢ç)å¾è¼å¾®</li>
    </ul>
  </li>
  <li>å¦æ TLB miss
    <ul>
      <li>åè¨­è©² TLB è¦å» Mapping ç Page å¨ Memory ä¸­åªè¦å° Virtual memory to Physical memory ç Mapping å å¥ TLB å³å¯</li>
      <li>ä¸è¿°çåä½å¯ä»¥ä½¿ç¨ Hardware ä¾å®æï¼æä½¿ç¨ Software ä¾å®æ</li>
    </ul>
  </li>
  <li>å¦æ TLB miss ä¸¦ä¸ Hardware çè¡¨æ ¼ä¹æ¥ä¸å°å¢
    <ul>
      <li>ç¨±ä¹çº Page fault</li>
    </ul>
  </li>
</ul>

<h3 id="what-is-virtual-memory">What is Virtual Memory</h3>

<h5 id="81-define-the-virtual-memory">8.1 Define the Virtual Memory</h5>

<p>å´æ ¼çå®ç¾©: <strong>ç±è»é«éæ°å®ç¾© Page fault</strong></p>
<ul>
  <li>ç¶ CPU æè¦å­åç Memory æ ¹æ¬ä¸å­å¨æ¼ DRAM ä¸­æï¼å°±ç¨±ä½çº Page fault
    <ul>
      <li>å¦ææååå Software æ­¤æè©² Software æè¦å­åç Memory æ ¹æ¬ä¸å­å¨æ¼ DRAM ä¸­ï¼å°±ç¨±ä½çº Page faultï¼ä¾å¦ Segmentation fault</li>
    </ul>
  </li>
  <li>OS è¨­è¨èéæ°è©®éäº Page fault çæç¾©ï¼ä¾å¦:
    <ul>
      <li>OS æ«æéæ²æè©² Page è¼å¥å° DRAM ä¸­ï¼éæ°è¼å¥å°±å¥½
        <ul>
          <li>ä¾å¦: Execl åå¦æ 500MB çè³æè¦æ¾å¥ DRAM ä¸­ä»¥ä¾å·è¡ï¼ä½ç¡¬ç¢çè®åéåº¦æä»çæ¥µéä¾å¦ 20MB/sï¼ä¸å¯è½æ¯æ¬¡å·è¡ Execl é½è¦è± 25 ç§éå»è®åè³æ</li>
          <li>åæå¿è¦çç¨å¼ç¢¼æ¾å¥ DRAM å°±å¥½ï¼ç­ä½¿ç¨èççéè¦ä½¿ç¨å¶ä»åè½æåå»è¼å¥è©²åè½</li>
        </ul>
      </li>
      <li>OS è®ä¸åç Process é±å½¢å±ç¨å§å®¹ç¸åç Page
        <ul>
          <li>å¯è®ï¼ä¸ææä»»ä½åé¡ç¼çï¼éå¯ä»¥æ¸å°è¨æ¶é«ä½¿ç¨éï¼ä¾å¦: fork() ä½¿ç¨ Copy-on-write çæè¡ä¾å¯¦ä½</li>
          <li>å¯«å¥ï¼OS å¿é ç¢ºä¿æ¯å Process å¨éè¼¯ä¸é½æèªå·±ç Pageï¼ä¾å¦: å³ä½¿ fork() ä½¿ç¨åä¸ä»½ Memoryï¼ä½æ¯è¦ç¢ºä¿ç¨å¼ç Logic address ä¸æ¯ä¸åç</li>
        </ul>
      </li>
    </ul>
  </li>
</ul>

<p>ç¨å¾®å¯¬é¬ä¸é»çå®ç¾©: <strong>è® Mapping è®å¾æ´å éæ´»</strong></p>
<ul>
  <li>ééè¨­å® MMUï¼ä½¿ Memory Mapping æ´å éæ´»çä¾å­
    <ul>
      <li>Shard Memoryï¼è®ä¸åç Process å¯ä»¥å±ç¨åä¸ä»½ Memory</li>
      <li>å¯ä»¥å°æªæ¡ Mapping å° Process ç Memory Spaceï¼è® Process å¯ä»¥ç´æ¥å­åæªæ¡</li>
      <li>å¯ä»¥å°é¨å I/O çè¨æ¶é« Mapping å° Process ç Memory Spaceï¼è® Process å¯ä»¥ç´æ¥æ§å¶ I/O
        <ul>
          <li>Linux ä¸­ä½¿ç¨ mmap å­å <code class="language-plaintext highlighter-rouge">/dev/mem</code></li>
        </ul>
      </li>
    </ul>
  </li>
</ul>

<h5 id="82-virtual-memory-components">8.2 Virtual Memory Components</h5>

<blockquote>
  <p>ä¸åæ¯ Virtual Memory ä¸­æéè¦ççµä»¶</p>
</blockquote>

<p><img src="/image/2023/12-23-virtual_memory/1.png" alt="" height="100%" width="100%" /></p>

<ul>
  <li>Hardware table(Page table)
    <ul>
      <li>éé¨åç± OS ä¾å¯«å¥ç¡¬é«æè¨­è¨çè¡¨æ ¼ï¼ç± MMU ä¾è®åï¼ä¾å¦: x86 å®ç¾©è¡¨æ ¼ï¼Linux ä¾ç§ x86 çå®ç¾©ä¾å¯¦ä½</li>
      <li>æ¯å Process é½æèªå·±ç Page table</li>
      <li>å¦æ TLB miss ç¡¬é«æ¥è©¢ Page table éæ¯æ¾ä¸å°ï¼æ­¤æè§¸ç¼ Page fault exception</li>
    </ul>
  </li>
  <li>Software table(mm_struct, kerne mapping table)
    <ul>
      <li>æ¯å Process çè³ Linux Kernel é½éè¦ä¸åæ¥è©¢è¡¨ï¼å¿«éçæ¥è©¢æ¯å Memory æ¯å¦æ­£ç¢º</li>
      <li>å¦ææ­£ç¢ºéç¼ç Page fault å¦ä½èçï¼</li>
    </ul>
  </li>
  <li>èç Page fault
    <ul>
      <li>OS å¿é æ Page fault handler(Interrupt service routine)</li>
      <li>ä¸¦ä¸è¦è½ç´é: é¯èª¤çåå ï¼é¯èª¤ç Address</li>
    </ul>
  </li>
</ul>

<h3 id="virtual-memory-example">Virtual Memory Example</h3>

<p><a href="#83-shard-memory">8.3 Shard Memory</a><br />
<a href="#84-demand-paging">8.4 Demand Paging</a><br />
<a href="#85-linux-pure-demand-paging">8.5 Linux Pure Demand Paging</a><br />
<a href="#86-performance-of-demand-paging">8.6 Performance of Demand Paging</a>
<a href="#87-copy-on-write">8.7 Copy-on-Write</a><br />
<a href="#88-kernel-same-page-merging">8.8 Kernel same-page merging</a><br />
<a href="#89-page-table-entry-attributes">8.9 Page Table Entry Attributes</a></p>

<h5 id="83-shard-memory">8.3 Shard Memory</h5>

<p><img src="/image/2023/12-23-virtual_memory/2.png" alt="" height="100%" width="100%" /></p>

<ul>
  <li>stack, heap éé¨åæ¯ç¨å¼èªå·±ç¨æç</li>
  <li>é»è²çé¨åæ¯å±äº«ç:
    <ul>
      <li>code, libc: éå©åæ¯åä¸åç¨å¼ä½æ¯éäºå©å Process
        <ul>
          <li>å çºå¨å·è¡ææå» Mapping ç¡¬ç¢ä¸çå·è¡æªï¼éæ¨£ OS å°±è½ç¥éå¶å¯¦éå©å Process å®å¨æ¯ä¸æ¨£ç</li>
          <li>ä¸¦ä¸éé¨ååªè½ Readï¼éæ¨£å°±æ²æ Locked æé æçæè½ç¶é ¸</li>
        </ul>
      </li>
      <li>mmap: éé¨åä¸æ¯ç± Kernel å»åäº«çï¼ç¶ Shell å»å¼å« mmap syscallï¼å¾å¾å°ä¸åç¬¦èéæ¨£å°±å¯ä»¥å°è©²è¨æ¶é«æ å°è³èªå·±ç Memory
        <ul>
          <li>shell-1 å°è³æå³çµ¦ shell-2 è¦å³çæ¯è³æå¨ mmap ä¸­ç offset</li>
          <li>ç¡éä¸è¦å»æå® mmap è¦è¢«æ å°ç Address</li>
        </ul>
      </li>
    </ul>
  </li>
  <li>Virtual Memory åè¨± Code, Data å±äº«
    <ul>
      <li>å¤åç¨å¼ä½¿ç¨ç¸åç Libraryï¼ä¾å¦: libc</li>
      <li>æç¨ç¨å¼éé Shared memory å±äº«è³æï¼ä¾å¦: mmap</li>
      <li>Parent å Child é½æ²å¼å« execv çè©±ï¼è¨æ¶é«å§å®¹å¹¾ä¹ä¸æ¨£ï¼ä¾å¦: Copy-on-Write</li>
    </ul>
  </li>
  <li>Linux åè¨±é±å«å¼çå±äº«
    <ul>
      <li>Linux kernel å¯è½æææ Memoryï¼å°å§å®¹ä¸æ¨£ç Page é±å«å±äº«</li>
      <li>ä¾å¦: é»è¦çæ¡å¸è·ç»å¥ç«é¢ä½¿ç¨åä¸å¼µåçï¼è¨æ¶é«å§å®¹æ¯ä¸æ¨£ç</li>
    </ul>
  </li>
</ul>

<h5 id="84-demand-paging">8.4 Demand Paging</h5>

<p><strong>Define of Demand paging</strong></p>

<ul>
  <li>ä½æ¥­ç³»çµ±ä¸æç«å»å°ä½¿ç¨èæéè¦ç Memory éç½®çµ¦ User</li>
  <li>ç¼ç Page fault æï¼ææè¼å¥è©²æ®µè¨æ¶é«çè³æ</li>
</ul>

<p><strong>Demand paging advantage</strong></p>

<p>å çºåªéè¦è¼å¥éè¦çè³æ</p>
<ul>
  <li>Less I/O needed</li>
  <li>Less memory needed</li>
  <li>Faster response
    <ul>
      <li>ååæéï¼åªéè¦è¼å¥éè¦çè³æå°±è½ååäº</li>
    </ul>
  </li>
  <li>More users/programs
    <ul>
      <li>å çºæ¯åç¨å¼éè¦çè¨æ¶é«è¼å°ï¼å æ­¤å¯ä»¥è¼å¥æ´å¤çæç¨ç¨å¼</li>
    </ul>
  </li>
</ul>

<p><strong>Demand paging shortcoming</strong></p>

<ul>
  <li>å°æ¼ Disk systemï¼Demand paging éç¶æ¸å°äºè®åçéï¼ä½æ¯æå¼ç¼å¤§éç Random access
    <ul>
      <li>ä¾å¦: å·è¡å©åç¨å¼ï¼éå©åç¨å¼ä¸å± 100 MBï¼OS å¯ä»¥é©å Disk ä½¿ç¨å©ç§éçæéä¾è¼å¥éå©åæç¨ç¨å¼ã</li>
      <li>å¦æä½¿ç¨ Pure demand pagingï¼åè¨­å©åç¨å¼è¼ªæµå·è¡ï¼ä¸å±éè¦ 20 MB 5120 å pagesï¼ä¸¦ä¸å·è¡çç¨å¼ç¢¼<strong>ãé¨æ©æ£å¸ã</strong>ï¼
ç®å Disk ç IOPS ç´çº 200ï¼åè¼å¥å©åç¨å¼çæéè®çº 25.6 Sec</li>
    </ul>
  </li>
  <li>é¤äºå¼ç¼å¤§éç Random access ä»¥å¤ï¼Demand paging ä¹å¯è½æé æå·è¡æéæäº Lag
    <ul>
      <li>ä¾å¦: ä¸å¸æç©éæ²æææå»¶é²ï¼å°±è¦ä¸æ¬¡æéæ²æè¦ç¨çè³æå¨é¨è¼å¥</li>
    </ul>
  </li>
</ul>

<blockquote>
  <p>Random access å° SSD çéåº¦å¤§ç´æ¯ Sequential access ç 1/2 ~ 1/3ï¼HDD åæå¯è½å¾ 200MB éä½å° 1MB</p>
</blockquote>

<blockquote>
  <p>IOPS: Input/Output Operations Per Second(æ¯ç§è¼¸å¥/è¼¸åºæ¬¡æ¸)</p>
</blockquote>

<p>Linux å¨éæ¹é¢çèçæ¹å¼æ¯åå¦è¦ 1å Pageï¼å°±æä¸æ¬¡è¼å¥å¨é­ 8 å Pageï¼å çºéå¸¸åä¸åç¨å¼æé£çºä½¿ç¨å°ç¸åç Pageï¼éæ¨£å°±è½æ¸å° Random access çåé¡ã</p>

<p><img src="/image/2023/12-23-virtual_memory/3.png" alt="" height="100%" width="100%" /></p>

<p>ä¸é¢å¼µåè¡¨ç¤ºäºä¸åç¨å¼éç½®å° DRAM çææ³</p>
<ul>
  <li>OS æéé process ç kernel mapping table ä¾çè¦å»åªè£¡æ¾è³æ
    <ul>
      <li>code, libc: disk</li>
      <li>stack, mmap, heap: zero-out page pool</li>
    </ul>
  </li>
  <li>zero-out page pool: OS æç¶­è­·ä¸å pool å¨éè£¡é¢é½æ¯å·²ç¶é ååå§å(0)ç pageï¼ç¨ä¾åéçµ¦ stack, mmap ä½¿ç¨
    <ul>
      <li>éæ¯çºäºé¿åè³è¨ï¼ä¾å¦: ä¸åç¨å¼çè³æéçå¨ DRAM ä¸­ï¼ä¸åç¨å¼å¯ä»¥å¾ DRAM è®åå°ä¸åç¨å¼çè³æ</li>
    </ul>
  </li>
</ul>

<blockquote>
</blockquote>

<p><strong>Valid-invalid</strong></p>

<p>ä¸åæ¯ä¸å x86 ç Page table entryï¼å¾é¢ç 12 å bit å°±æ¯ attribute</p>

<p><img src="/image/2023/12-23-virtual_memory/4.png" alt="" height="100%" width="100%" /></p>

<ul>
  <li>Present: 0 çè©±è¡¨ç¤ºè©² Page ä¸å¨ DRAM ä¸­ï¼æ­¤æå¯è½ä»£è¡¨ OS éæ²æå°è©² page è¼å¥ DRAM ä¸­ï¼æèè©² page æ¬ä¾å°±ä¸å¨ DRAM ä¸­(ç¨å¼å¯«é¯)</li>
  <li>ä¸ç®¡æ¯å¨ page table ä¸­çç¬¬ä¸å±¤æç¬¬äºå±¤ï¼åªè¦æä¸åæ¯ 0(invalid)ï¼å°±æè§¸ç¼ exception</li>
  <li>æ­¤æ OS æå»æ¥è©¢ process çè»é«è¡¨æ ¼(Linux mm_struct)
    <ul>
      <li>æ¥è©¢æå: éç½® physical page çµ¦è©² addressï¼ç¶å¾ä¿®æ¹ page table éæ°å·è¡</li>
      <li>æ¥è©¢å¤±æ: ç¨å¼ç¼çé¯èª¤ï¼ä¾å¦: pointer æåé¯èª¤ç addressï¼æ­¤æç¹¼çºé¯èª¤èç(çµæ­¢æå¼å« GDB)</li>
    </ul>
  </li>
</ul>

<blockquote>
  <p>å¤§é¨åç valid-invalid bit é½å¨ PTE çæå³éï¼éæ¯ CPU è¨­è¨æå¦ææåä¸å­å¨ç pageï¼å¨æ­¤æåè®å¾ bit é½å¯ä»¥ä»»æä½¿ç¨ï¼
Linux å°±ä½¿ç¨éäº bit ä¾åå©è§£æ±º backing storage çº swap space ç page fult</p>
</blockquote>

<h5 id="85-linux-pure-demand-paging">8.5 Linux Pure Demand Paging</h5>

<blockquote>
  <p>Pure demand paging çæææ¯å¨å·è¡æ°çç¨å¼æï¼ä¸¦ä¸æåéä»»ä½ page çµ¦ taskï¼ç´å°è©² task ç´¢å</p>
</blockquote>

<p>ä»¥ Linux çºä¾å­ï¼ä½¿ç¨ execve() å°å·è¡æªæ¾å¥ç¶å process ç memory space</p>
<ol>
  <li>åå¨è©² task ç mm_struct ä¸­è¨­å® section æ å°çè³è¨
    <ul>
      <li>code, data å°æå°å·è¡æªæ¡</li>
      <li>bss section å°æå° zero-out page pool</li>
      <li>lib å°æå°ç¸å°ç library</li>
      <li>åªåéå°éç stack space(8KB) çµ¦è©² task</li>
    </ul>
  </li>
  <li>å·è¡ç¨å¼</li>
</ol>

<p>Linux ä¸¦æ²æåéä»»ä½ page åçµ¦è©² taskï¼å æ­¤æ¯ pure demand paging</p>

<h5 id="86-performance-of-demand-paging">8.6 Performance of Demand Paging</h5>

<p>æéº¼ä¼°ç® Demand Paging çæè½ï¼å¦ä¸:</p>
<ul>
  <li>Page fault rate: 0 &lt;= p &lt;= 1
    <ul>
      <li>ä¼°ç®ä¸å Page fault ç¼ççæ©ç</li>
    </ul>
  </li>
  <li>Effective Access Time(EAT)
$EAT = (1 - p) * memory\,access + p(page\,fault\,overhead + swap\,page\,out + swap\,page\,in + restart\,overhead)$
    <ul>
      <li>swap page out: Free space ä¸å¤ å°±éè¦å°æäº page å¾ DRAM å¯«å¥ disk
        <ul>
          <li>åªåæ¹å¼: ç¡è«å¦ä½é½ä¿æä¸å®ç free space</li>
        </ul>
      </li>
      <li>swap page in: ç¶ page fault ç¼çæï¼éè¦å°æäº page å¾ disk è®å¥ DRAM
        <ul>
          <li>å¸¸ç¨ç page å°±åæ¾å¥ page cache ä¸­ï¼ä¾å¦: <code class="language-plaintext highlighter-rouge">ls</code></li>
        </ul>
      </li>
      <li>page fault overhead, restart overhead: éå©å overhead éå¸¸æ¯ç¡¬é«ç¸éçåé¡ï¼æ ISR çé¨å assembly å¯«çå¤ ä¸å¤ å¥½</li>
    </ul>
  </li>
</ul>

<blockquote>
  <p>OS ä¸ä¸»è¦è½åªåçå°±æ¯ swap page out/in éå©ç¨®æ¹å¼</p>
</blockquote>

<p><strong>Example</strong></p>

<ul>
  <li>Memory access time: 200 nanoseconds</li>
  <li>Average page-fault service time: 8 milliseconds
    <ul>
      <li>EAT = (1 - p) * 200 + p(8,000,000)<br />
= 200 + p * 7,999,800</li>
    </ul>
  </li>
  <li>å¦ææ¯ 1000 æ¬¡ memory access æ 1 æ¬¡ page faultï¼é£éº¼éåº¦å°è®çºåæ¬ç 1/40</li>
</ul>

<blockquote>
  <p>ä»¥ä¸çä¾å­æ¯èªªæï¼å¨å¯è½çææ³ä¸ç¡éå°ç¨ swap spaceï¼éæ¨£å¯è½æé æ CPU å¤§éçæéé½å¨ idle</p>
</blockquote>

<h5 id="87-copy-on-write">8.7 Copy-on-Write</h5>

<p>å¨ Physical memory ä¸­ä¹æä½¿ç¨ Copy-on-Write çæè¡ï¼ä¾å¦: å¨å fork() åºä¾ç child processï¼å¦æ child process æ²æä¿®æ¹ä»»ä½è³æï¼
å°±ä¸æççè¤è£½ä¸ä»½ parent process çè³æï¼èæ¯å±ç¨åä¸ä»½è³æï¼éæ¨£å°±è½æ¸å°è¨æ¶é«çä½¿ç¨éã</p>

<p><img src="/image/2023/12-23-virtual_memory/5.png" alt="" height="100%" width="100%" /></p>

<ul>
  <li>éå¸¸ fork ä¹å¾ç parent è child
    <ul>
      <li>å¨ register ä¹å¤é½æ¯ä¸æ¨£çï¼å æ­¤ç´æ¥ copy parent ç mm_struct çµ¦ child</li>
      <li>å° parent è child ç page table é½è¨­å®çº read-only</li>
    </ul>
  </li>
  <li>å¨ read-only ä¹å¾å¦æå¶ä¸­ä¸å task å»ä½åºä¿®æ¹ï¼å°±æè§¸ç¼ page fault
    <ul>
      <li>Linux æé æ page fault ç page æ¹æ writeableï¼ä¸¦ä¸è¤è£½ä¸ä»½ page çµ¦ child</li>
      <li>éæ¨£ parent è child å°±éæ°åèªææä¸ä»½å¯ write ç page</li>
    </ul>
  </li>
</ul>

<blockquote>
  <p>éæ¨£çæè¡ä¹å¯ä»¥ç¨å¨ File System ä¸ï¼ä¾å¦: Linux ç Btrfs</p>
</blockquote>

<h5 id="88-kernel-same-page-merging">8.8 Kernel same-page merging</h5>

<ul>
  <li>Kernel virtual memory(KVM) ä¸­ææè¨±å¤ä¸åç VM é½æç¨å°ç¸åç page
    <ul>
      <li>ä¾å¦: é½æ¯å·è¡ Win10ï¼é£éº¼éäº VM ä¸­ç OS Kernel æè©²é½æ¯ä¸æ¨£ç</li>
    </ul>
  </li>
  <li>å¨ä¸è¬ç OS ä¹å¯è½ææç¸åç Page
    <ul>
      <li>ä¾å¦: æ¡é¢èç»å¥ç«é¢ä½¿ç¨ç¸åçåçï¼éæ¨£å°±ææç¸åç Page</li>
    </ul>
  </li>
  <li>ä¸é¢çææ³é½æ¯è¼é£æçæ­£çäºä»¶ç¼çï¼å æ­¤éè¦ OS å»ä¸»åæææè½ç¼ç¾å±ç¨è¨æ¶é«ï¼ç¯çè¨æ¶é«çä½¿ç¨é</li>
</ul>

<h5 id="89-page-table-entry-attributes">8.9 Page Table Entry Attributes</h5>

<p>å¨ Main Memory ä¸­ä»ç´¹çæ¯ PTE çå 20 å bitï¼ééææ´è©³ç´°çèªªæå¾ 12 å bit çæç¾©</p>

<p><img src="/image/2023/12-23-virtual_memory/4.png" alt="" height="100%" width="100%" /></p>

<ul>
  <li>Present: æ¯å¦å¨ DRAM ä¸­</li>
  <li>Read/Write: 0 è¡¨ç¤º read-onlyï¼1 è¡¨ç¤º read/write</li>
  <li>User/Supervisor: è¡¨ç¤ºæ¯å¦éè¦ kernel mode æ¬éæè½å­å</li>
  <li>Write-through: æ±ºå® page ä½¿ç¨çæ¯ write-back æ write-through</li>
  <li>Cache Disable: å¦ææ¯ 1 åç¦æ­¢è©² page è¢« cache</li>
  <li>Accessed: è¡¨ç¤ºè©² page æ¯å¦è¢«å­åé</li>
  <li>Dirty: è¡¨ç¤ºè©² page æ¯å¦è¢«ä¿®æ¹é</li>
  <li>Page Table Attribute Index: è· Write-through/Cache Disable æéï¼å¯ä»¥è¨­ç½®æ´ç´°ç·»ç Cache è¨­å®</li>
  <li>Global: è¡¨ç¤ºè©² page æ¯å¦æ¯ global pageï¼ä¾å¦: å±äº«ç library</li>
  <li>Available: é 3 å bit å¯ä»¥è® OS èªç±ä½¿ç¨</li>
</ul>

<p>èä¸å 4KB ç Page table å¯ä»¥æ¾å¥ 1024 å PTEï¼ç¶å¾å¨ Main memory æéç Hierarchical pading å¨éè£¡å¯ä»¥æ´è©³ç´°çèªªæï¼
éæ¨£çè©±æ¶æ§å°±æå¦ä¸(ä»¥ 4 å PTE çµæä¸å±¤ Page table çºä¾):</p>

<p><img src="/image/2023/12-23-virtual_memory/6.png" alt="" height="100%" width="100%" /></p>

<p>éæ¨£æåå°±è½æ Page table, TLB, Virtual memory, Physical memory çµåèµ·ä¾ï¼å¦ä¸:</p>

<p><img src="/image/2023/12-23-virtual_memory/7.png" alt="" height="100%" width="100%" /></p>

<ol>
  <li>Virtual address éé TLB è½ææ Physical address
    <ul>
      <li>TLB ç´é virtual address è physical address ç mapping</li>
      <li>attribute ä¹æç´éå¨ TLB ä¸­</li>
    </ul>
  </li>
  <li>TLB miss æè§¸ç¼ page faultï¼éé CR3 register æ¾å° page table</li>
  <li>Page table ç´é virtual address è physical address ç mapping
    <ul>
      <li>page table æ¾å° physical address å¾å»æ´æ° TLBï¼ç¶å¾éæ°æ¥è©¢</li>
      <li>å¦æ PTE æ¯ invalidï¼å°±æè§¸ç¼ page faultï¼åå»è¼å¥è©² page å° DRAM ä¸­</li>
    </ul>
  </li>
</ol>

<blockquote>
  <p>å°éè£¡çºæ­¢å°±æ¯å®æ´ç Virtual memory å° Physical memory çéä½æ¹å¼</p>
</blockquote>

<hr />

<h3 id="page-replacement">Page Replacement</h3>

<blockquote class="block-tip">
  <p>å¨éä¹åæè¨è«çé½æ¯å¨ DRAM è¶³å¤ æ»¿è¶³ç¨å¼å¤§å°çææ³ï¼ä½æ¯å¯¦éä¸ DRAM ä¸¦ä¸ä¸å®è½æ»¿è¶³ç¨å¼æéè¦çå¤§å°</p>
</blockquote>

<p><a href="#810-why-need-page-replacement">8.10 Why Need Page Replacement</a><br />
<a href="#811-page-replacement-concept">8.11 Page Replacement Concept</a><br />
<a href="#812-page-replacement-algorithm">8.12 Page Replacement Algorithm</a><br />
<a href="#813-algorithm-evaluation-example">8.13 Algorithm Evaluation Example</a><br />
<a href="#814-linuxs-page-replacement">8.14 Linuxâs Page Replacement</a></p>

<h5 id="810-why-need-page-replacement">8.10 Why Need Page Replacement</h5>

<p>ä¸»è¦çåå å°±æ¯ DRAM æéï¼ä¾å¦: ä½¿ç¨èåæå·è¡äº Excel, Word, Chromeï¼éä¸åç¨å¼çå¤§å°å èµ·ä¾è¶éäº DRAM çå¤§å°ï¼
æèæ¯ä½¿ç¨èæ­£å¨çä¸é¨å½±çï¼ä½æ¯éé¨å½±ççå¤§å°è¶éäº DRAM çå¤§å°ã</p>

<blockquote>
  <p>ä¾å¦ä¸å 6.2GB çå½±çï¼ä½¿ç¨èåªæ 6GB ç DRAMï¼å°±åæ 200MB çè³æå¯«å¥ swap spaceï¼éè¦æåå¾ swap space è®å</p>
</blockquote>

<ul>
  <li>å çº Virtual memory çå­å¨ï¼æä»¥ OS å¯ä»¥åªè¼å¥ç®åæéè¦çè³æ
    <ul>
      <li>é¨èç¨å¼çå·è¡ï¼éå»æéè¦çè³ææä¸æ·ç´¯ç©ï¼ä½ä¸ä»£è¡¨éäºè³æå¯ä»¥è¢«ä¸æ£</li>
      <li>å æ­¤ç¶ DRAM ä¸è¶³æï¼OS è¦èæ®æ¯å¦æéäºè³æå¯«åºå° secondary storage æä¸æ£</li>
    </ul>
  </li>
</ul>

<blockquote>
  <p>ä¾å¦: ä¸å word çç¨å¼ç¨ä¾åå§å wordï¼ä½æ¯æ¥ä¸ä¾ä¸æåä½¿ç¨ï¼éæå°±å¯ä»¥æéäºè³æä¸æ£</p>
</blockquote>

<h5 id="811-page-replacement-concept">8.11 Page Replacement Concept</h5>

<p>å¨ memory ä¸­æåæéº¼æ¾åºæè¿ä¸æä½¿ç¨å°ç pageï¼éå°±æ¯ page replacement algorithm çç®ç</p>
<ul>
  <li>éå algorithm è¨­è¨çå¥½å¯ä»¥è®ä½¿ç¨èæè¦ºä¸å° page replacement çå­å¨
    <ul>
      <li>ç¶ç¶ä¹æå¯è½è¨­è¨çä¸å¥½ï¼é æä½¿ç¨èæè¦ºå° lag</li>
    </ul>
  </li>
  <li>å¨ä¸èæ® page-out/page-in overhead çææ³ä¸ï¼user å¯ä»¥ä½¿ç¨ç memory é è¶ DRAM çå¤§å°
    <ul>
      <li>åè¨­ user å·è¡çæç¨ç¨å¼å±éè¦ 12GB çè¨æ¶é«ï¼ä½ user åªæ 4GB ç DRAM</li>
      <li>ä¾ç§æªä¾æå­åçé åºä¾å° 12GB çè¨æ¶é«åæåºï¼å°±å¯ä»¥ç¥éåªäº page åªåè¢«æ¾å¥ DRAM</li>
    </ul>
  </li>
  <li>çºä»éº¼åªè¦ä»å¥é¨åè³æå°±å¯ä»¥
    <ul>
      <li>ä¾å¦: 10ç§éå§ï¼user è½å­åçè³æä¸æè¶é 4GB(locality)</li>
      <li>å¦æè¶é 4GBï¼é£éº¼å°±æé¨åè³æ page-outï¼ç¶å¾ page-in éè¦çè³æ</li>
    </ul>
  </li>
</ul>

<blockquote class="block-warning">
  <p>å¯¦éå¨ Linux å·è¡ä¸­å¯ä»¥ä½¿ç¨ free -h å»æ¥çä½¿ç¨ç Men, Swapï¼Linux ä¸¦ä¸æççæ Men ä½¿ç¨åï¼èæ¯æä¿çä¸é¨åç Men åçº page cacheï¼
available åæ¯å¨ä¸ä½¿ç¨ swap çææ³ä¸å¯ä»¥åéå¤å°è¨æ¶é«</p>
</blockquote>

<p>é£éº¼å¨ 512MB çé»è¦ä¸å·è¡ 6.3 GB çç¨å¼ï¼æç¼çä»éº¼</p>

<ul>
  <li>çè«ä¸ç³»çµ±çææè¢«ä½¿ç¨çè¨æ¶é«å¤§å°ä¸è½è¶é DRAM + Swap</li>
  <li>OS kernel æ¬èº«æ¯ non-swappable
    <ul>
      <li>æä»¥ OS æ¬èº«æéè¦çè¨æ¶é«é½æç´æ¥éç½®å¨ DRAM ä¸­ï¼éè£¡ä¸¦ä¸æ¯ kernel ä¸è½è¢«è¨­è¨æ swappableï¼èæ¯éæ¨£çè¨­è¨ä¸åç</li>
    </ul>
  </li>
  <li>OS æå¨å¿è¦æ kill æä¸äº taskï¼ç¨±çº OOM killer(out-of-memory killer)</li>
</ul>

<h5 id="812-page-replacement-algorithm">8.12 Page Replacement Algorithm</h5>

<p>éè£¡è¦è¨è«çå°±æ¯é£äº page æè©²è¢«ä¸æ£ï¼éå°±éè¦ page replacement algorithm ä¾æ±ºå®</p>

<ul>
  <li>Algorithm çç®æ¨: æå°å page fault çæ¸é
    <ul>
      <li>éè£¡è¦çåªåçç®æ¨æ¯ä»éº¼ï¼å¨éè£¡è¨è«çæ¯æå°å page fault çæ¸é</li>
    </ul>
  </li>
  <li>å¨éè£¡æè¨è«ä»¥ä¸å¹¾ç¨® algorithm
    <ul>
      <li>FIFO: First-in-first-out</li>
      <li>Optimal algorithm
        <ul>
          <li>æ¦å¿µä¸çæä½³åï¼å¿éåè¨­ç¥éæªä¾ç Page access pattern</li>
        </ul>
      </li>
      <li>LRU: Least-recently-used
        <ul>
          <li>éå»ä¸æ¾ç¨å°ç pageï¼æªä¾ä¹ä¸å¤ªå¯è½æç¨å°</li>
          <li>å¯¦ç¾ææå¢å ç¡¬é«ä¸çææ¬ï¼å çºè¦å å¥ä¸åæéæ³è¨</li>
        </ul>
      </li>
      <li><strong>Second-chance</strong>
        <ul>
          <li>ææä¸ä½ææ¬çæ¹å¼ä¾å¯¦ç¾æ¥è¿ LRU çææ</li>
        </ul>
      </li>
      <li>LFU: Least-frequently-used
        <ul>
          <li>éå»æä¸å¸¸ç¨ç pageï¼æªä¾ä¹ä¸å¤ªå¯è½æç¨å°</li>
        </ul>
      </li>
      <li>MFU: Most-frequently-used
        <ul>
          <li>éå»æå¸¸ç¨ç pageï¼å¯è½ä»£è¡¨å·²ç¶ä½¿ç¨çµæäºï¼æä»¥ä¹å¾ä¸æç¨å°</li>
        </ul>
      </li>
      <li><strong>Linuxâs page replacement</strong></li>
    </ul>
  </li>
</ul>

<p><strong>Basic assessment method</strong></p>

<p>å¨ç­ç­è©ä¼°æ¼ç®æ³çæ¹å¼ä¸­ï¼æä½¿ç¨ä»¥ä¸çæ¹å¼ä¾è©ä¼°:</p>
<ul>
  <li>å¨çµ¦å®ç Reference string ä¸­ï¼è¨ç® page fault çæ¸é</li>
  <li>Reference string:
    <ul>
      <li>7, 0, 1, 2, 0, 3, 0, 4, 2, 3, 0, 3, 2, 1, 2, 0, 1, 7, 0, 1</li>
      <li>éå reference string ä»£è¡¨äºä¸åç¨å¼ç page access pattern</li>
    </ul>
  </li>
  <li>å¨éè£¡åè¨­ç³»çµ±åªæ 3 å frame</li>
</ul>

<h5 id="813-algorithm-evaluation-example">8.13 Algorithm Evaluation Example</h5>

<p><strong>FIFO</strong></p>

<p><img src="/image/2023/12-23-virtual_memory/8.png" alt="" height="100%" width="100%" /></p>

<ul>
  <li>æ¿ææææ©é²å¥ç page
    <ul>
      <li>æä»¥ç¶ 4, 0, 1, 2 æï¼å° 4 Swap out</li>
    </ul>
  </li>
</ul>

<p><strong>Optimal algorithm</strong></p>

<p><img src="/image/2023/12-23-virtual_memory/9.png" alt="" height="100%" width="100%" /></p>

<ul>
  <li>ææ©æ¿æææªä¾æä¹ä¸æä½¿ç¨å°ç page
    <ul>
      <li>æä»¥ç¶ 4, 0, 1, 2 æï¼ç¼ç¾æªä¾ä¸æä½¿ç¨å° 1ï¼å æ­¤å° 1 Swap out</li>
      <li>æ¥ä¸ä¾å° 0, 3 æç¼ç¾ 0 éæä¸æ¬¡ Access ææä½¿ç¨ï¼æä¹å æ­¤å° 0 Swap out</li>
    </ul>
  </li>
  <li>å¯¦éä¸éæ¨£çæ¼ç®æ³æ¯ä¸å¯è½çï¼å çºæåä¸å¯è½ç¥éæªä¾ç Access pattern</li>
</ul>

<p><strong>LRU</strong></p>

<blockquote class="block-tip">
  <p>æåç¡æ³å¾ç¥æªä¾ç Access patternï¼ä½æ¯å¯ä»¥ç¥ééå»ç Access pattern</p>
</blockquote>

<p><img src="/image/2023/12-23-virtual_memory/10.png" alt="" height="100%" width="100%" /></p>

<ul>
  <li>æ¿æææä¹æ²æä½¿ç¨ç page
    <ul>
      <li>æä»¥ç¶ 4, 0, 1, 2 æï¼å° 4 Swap out</li>
      <li>æ¥ä¸ä¾å° 0, 3 æç¼ç¾ 1 æ¯æå¾ä½¿ç¨çï¼å æ­¤å° 1 Swap out</li>
    </ul>
  </li>
</ul>

<p><strong>Second-chance(clock algorithm)</strong></p>

<blockquote class="block-tip">
  <p>LRU å¦æè¦å¨ç¡¬é«ä¸å¯¦ç¾ï¼éè¦ä¸åæéæ³è¨ï¼ä½æ¯éæ¨£æå¢å ç¡¬é«çææ¬ï¼å æ­¤æäº Second-chance</p>
</blockquote>

<p><img src="/image/2023/12-23-virtual_memory/4.png" alt="" height="100%" width="100%" /></p>

<p>Second-chance å¯ä»¥ç¨ PTE ä¸­ç</p>
<ul>
  <li><strong>Accessed bit</strong>(ä¹ç¨±çº Reference bit)ä¾å¯¦ç¾ï¼ç¶ page è¢«å­åæï¼OS æå° Accessed bit è¨­çº 1ï¼OS æå®æå»æ¸é¤ Accessed bit æ¹çº 0ã</li>
  <li><strong>Dirty bit</strong> åæ¯å¨ page è¢«ä¿®æ¹æï¼OS æå° Dirty bit è¨­çº 1ï¼å¦ææ Dirty bit çº 1 ç page-outï¼å°±ä»£è¡¨å¿é è¦è· disk ååæ­¥ï¼å æ­¤æå¢å  page-out çæéã</li>
  <li>å¦æä»¥ä¸å©å bit é½æ¯ 0ï¼å°±ä»£è¡¨éå page æ¯å¯ä»¥è¢« page-out ä¸¦ä¸ææ¬ä½ç</li>
</ul>

<p><img src="/image/2023/12-23-virtual_memory/11.png" alt="" height="100%" width="100%" /></p>

<ul>
  <li>å¯¦éä¸åè¼å¥ç memory ç page accessed bit é½æ¯ 0ï¼å æ­¤æåè¢«æ¿ææ
    <ul>
      <li>éæ¨£åè¨­ A åè¼å¥ä¸å page p, æ­¤æ B ctx ä»æå¯è½ææ A ç page p æ¿ææï¼éæ¨£åå° A åè¦éæ°è¼å¥ p</li>
      <li>è§£æ±ºæ¹å¼æ¯å¨ä¸äº OS ä¸ææ young bitï¼æèæ¯å¨è¼å¥æå°±å° accessed bit è¨­çº 1</li>
    </ul>
  </li>
  <li>ç´è²çå­é«å°±æ¯å Access ç pageï¼å¨å¯¦ä½ä¸å¯ä»¥æå¾å¤æ¹å¼
    <ul>
      <li>éè£¡ä½¿ç¨ä¸å Pointer ä¾åºæå pageï¼ç¶ page è¢«æåç¬¬äºæ¬¡æä¸¦ä¸ accessed bit çº 0ï¼éåå¯ä»¥ page-out</li>
    </ul>
  </li>
</ul>

<blockquote class="block-danger">
  <p>Second-chance æå¾å¤ç¨®å¯¦ä½æ¹å¼ï¼éè£¡åªæ¯å¶ä¸­ä¸ç¨®</p>
</blockquote>

<p><strong>LFU</strong></p>

<p><img src="/image/2023/12-23-virtual_memory/12.png" alt="" height="100%" width="100%" /></p>

<ul>
  <li>ä¸æ¹çæ©è²åå¡ä»£è¡¨è©² page è¢«ä½¿ç¨çæ¬¡æ¸
    <ul>
      <li>ç¶éè¦ swap out æï¼å°±ææ¾å°ä½¿ç¨æ¬¡æ¸æå°ç page page-out</li>
    </ul>
  </li>
  <li>å¦æä½¿ç¨æ¬¡æ¸é½ä¸æ¨£éè£¡å°±åè¨­ FIFO</li>
</ul>

<p><strong>MFU</strong></p>

<p><img src="/image/2023/12-23-virtual_memory/13.png" alt="" height="100%" width="100%" /></p>

<ul>
  <li>è LFU ç¸åï¼æ¾å°ä½¿ç¨æ¬¡æ¸æå¤ç page page-out</li>
</ul>

<p><strong>Conclusion</strong></p>

<ul>
  <li>Optimal algorithm: çè«ä¸æä½³åï¼ä½æ¯ä¸å¯è½ç¥éæªä¾ç Access pattern</li>
  <li>LRU: åºæ¼éå»é æ¸¬æªä¾ï¼å¯¦éä¸çæè½ä¸é¯
    <ul>
      <li>ä½æ¯è¦å®å¨å¯¦ç¾ LRU éè¦å¢å ç¡¬é«ææ¬ï¼ä¾å¦: ç´é page ä¸æ¬¡è¢«å­åçæé</li>
    </ul>
  </li>
  <li>Second-chance: ææä¸ä½ææ¬çæ¹å¼ä¾å¯¦ç¾æ¥è¿ LRU çææ
    <ul>
      <li>å¦æç¶å¸¸è¢«å­åï¼é£ Access bit æä¸ç´è¢«è¨­çº 1</li>
      <li>è¦ replancement çæåæçµ¦æ Access bit ç page ä¸å second chance</li>
      <li>å¾æ¥é² LRU çæ¹å¼ï¼ç¸ç¶æ¼ä½¿ç¨ 1 å bit ä¾ç¶ä½æéæ³è¨</li>
    </ul>
  </li>
  <li>FIFO: ç°¡å®ï¼ä½æ¯æè½ä¸å¥½
    <ul>
      <li>å çºæ¾å¨ memory ä¸­å¤ä¹è· page æ¯å¦æè¢«ä½¿ç¨æ²æç´æ¥éä¿</li>
    </ul>
  </li>
  <li>LFU: ä¿çéå»å¸¸ç¨ç pageï¼éè¦ä¸äºæ©å¶ä¾æ¶é¤ç´¯ç©ç page æ¬¡æ¸ï¼ä¸ç¶æå¯è½é ææäº page ä¸ç´è¢«çå¨ DRAM ä¸­</li>
  <li>MFU: æé¤éå»å¸¸ç¨ç pageï¼éå¸¸æ¯å¨ç¹å®ææ³ä¸æææè¼å¥½çææ</li>
</ul>

<h5 id="814-linuxs-page-replacement">8.14 Linuxâs Page Replacement</h5>

<blockquote class="block-tip">
  <p>Linux ä½¿ç¨äºå©å LRU list ä¾å¯¦ç¾ page replacement</p>
</blockquote>

<p><img src="https://www.kernel.org/doc/gorman/html/understand/understand-html059.png" alt="" height="100%" width="100%" /></p>

<p>è¨­è¨å©å LRU çå¥½èæ¯é¿åä¸äº page å»æ±æ active listï¼ä¾å¦: ä¸åä¸æ¬¡æ§ä½å¾å¤§çç¨å¼ï¼é£æå¯è½å°±ææ active list ä¸­çæ­£éè¦ç page è¸¢åºå»ï¼
æ inacitve list å°±å¯ä»¥è®éäºä¸æ¬¡æ§ç page ä¿çå¨ inactive list ä¸­ï¼ä¸æå½±é¿å° active listã</p>

<ul>
  <li>å©å LRU list: active, inactive list
    <ul>
      <li>Active list: æè¿æ¯è¼æ´»èç page</li>
      <li>Inactive list: æè¿æ¯è¼ä¸æ´»èç page
        <ul>
          <li>incative list æå®æçå»æª¢æ¥å¨ä¸æ®µæéå§æ¯å¦æ page è¢«å­åéå©æ¬¡ï¼å¦ææå°±æè¢«ç§»åå° active list head</li>
        </ul>
      </li>
    </ul>
  </li>
</ul>

<blockquote>
  <p>å¾ Active/Inactive list ç§»é¤ page ä½¿ç¨çæ¯ <strong>Second-chance algorithm</strong></p>
</blockquote>

<ul>
  <li>New page éå¸¸æè¢«æ¾å¥ inactive list ç head</li>
  <li>Inactive list è¢«å¡«æ»¿ï¼å°±æå° tail çé¨å page ç§»å° swap space</li>
  <li>Active list è¢«å¡«æ»¿ï¼å°±æå°æ tail ç page ç§»å° inactive list head
    <ul>
      <li>éæ¨£çå¥½èæ¯ï¼page å¨ inactive list ä¸­ä¸ç´æ²æè¢«å­åï¼å°±ææ¢æ¢ç§»åå° tailï¼æå¾å°±æè¢«ç§»åº DRAM</li>
    </ul>
  </li>
  <li>page é¢é inactive list æï¼ææè©² page ç´éå¨ table ä¸­ï¼éå table åªæç´éæè¿ä¸æ£ç page
    <ul>
      <li>å¦ææ new page é²å¥æï¼å°±ææª¢æ¥ table ä¸­æ¯å¦æç¸åç pageï¼å¦ææå°±æè©² page ç§»å° active list head</li>
    </ul>
  </li>
</ul>

<p>å¦ææè¿è®å¥ç page åå¥½å¨ swap-out table ä¸­ï¼å°±è¡¨ç¤ºæ¼ç®æ³æå¤±èª¤ï¼ä¾å¦: éå page æè¢«å¸¸å¸¸ä½¿ç¨ï¼åªæ¯å­åçééæ¯ inactive list çæéé·ã</p>

<ul>
  <li>æä»¥éè£¡æé¸ææéå page ç§»å° active list
    <ul>
      <li>ä¸é² active list å¯ä»¥çµ¦ä»æ¯å¨ inactive list æ´é·çæéææ©æè¢«å­å</li>
    </ul>
  </li>
  <li>éè£¡å¯ä»¥è¨è«çæ¯æ¯å¦è¦è¨ééåééæå¤é·ï¼è¦ä¸è¦ä»¥æ­¤å»èª¿æ´ inactive list çæé</li>
</ul>

<blockquote>
  <p>å»¶ä¼¸é±è®: <a href="https://www.kernel.org/doc/gorman/html/understand/understand013.html">Linux Page Replacement</a></p>
</blockquote>

<ul>
  <li>éæ¼éå Swap-out table çè¨­è¨ï¼ä»çéææè¨±ä¾èª ãAdaptive Replacement Cacheã(IBM)</li>
  <li>ä½¿ç¨ Active + Inactive
    <ul>
      <li>èåäº LRU + LFUï¼åªè¦å¸¸å¸¸è¢«å­åï¼å³ä½¿ä¸æ¯æè¿è¢«å­åçä¹ä¸å¤ªå®¹æè¢«ç§»åº DRAM</li>
    </ul>
  </li>
</ul>

<blockquote>
  <p>å¨æ­¤ä¹ä¸å¯ä»¥æèçæ¯ï¼æ¯å¦å¯ä»¥æ Active + Inactive è®ææ´å¤å±¤ççµæ§</p>
</blockquote>

<p><strong>Linux Page Replacement Steps</strong></p>

<p>è¦æ³¨æéè£¡ææå°ç Active/Inactive list æ¯ OS ä¸çè³æçµæ§ï¼æä»¥çæ­£ç Asecced bit æ¯å¨ page table ä¸ï¼
éå©å list æå²å­çæ¯ DRAM ä¸­ç physical addressã</p>

<p>å¨ OS ä¸çè³æçµæ§å¦ä½å»ç¥é Access bit çè®åï¼å¯¦éç Access bit æ¯å­å¨ task ç page table ä¸:</p>
<ol>
  <li>ææ Inactive listï¼è¦ååçå¾ physical page å»æ¾åºå°æç page tabe</li>
  <li>å¾ page table ä¸­æè©² Page ç Access bit mapping å° Inactive list ç page</li>
</ol>

<p>å çº Linux ä¸­ç Inactive list æ¯ä½¿ç¨ Second-chance algorithmï¼å æ­¤æ¯æ²¿è circular list ä¸æ·å¾ä¸æææ¯ä¸å entryï¼
éä¸å»æ´æ° entry ä¸­ç Access bit å³å¯ã</p>

<p>éæ¨£ç§»é¤çæåä¹è¦ååçå»æ¾åºå°æç page tableï¼ç¶å¾æ´æ° page table ä¸­ç valid bitï¼ç¶å¾å°±å°è©² page ç§»å° swap spaceï¼
mm_struct ä¸­ç page table æè¨ééå page çä½¿ç¨ææ³æ¯å¨ swap space éæ¯å¨ disk ä¸­ã</p>

<blockquote class="block-warning">
  <h5 id="last-edit">Last Edit</h5>
  <p>1-31-2023 21:14</p>
</blockquote>

</section>
            </div><div class="search-results">
    <div class="has-results">
        <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
        <ul class="search-results-list"></ul>
    </div>
    <div class="no-results">
        <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
    </div>
</div></div>
        <div class="normal">
            <section class="normal">
                
                <i class="fa fa-eye"></i>
                <span id="page-hit-tracker"></span>, 
                <i class="fa fa-archive"></i>
                
                OS
                
                
            </section>
        </div>
    </div>
<script async src="https://www2.cs.ccu.edu.tw/~xbs112m/tracker.php"></script>
</div>

<!-- introduce mathjax support -->
<script>
window.MathJax = {
  tex: {
    inlineMath: [ ['$', '$'], ['\\(', '\\)'] ]
  },
  svg: {
    fontCache: 'global'
  }
};
</script>
<script
  type="text/javascript" id="MathJax-script" async
  src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js">
</script>


<!-- introduce per-page mermaid support -->


<!-- introduce mathjax support -->
<script>
    function fixes_chrome_anchors() {
        let chrome = /Chrome/.test(navigator.userAgent) && /Google Inc/.test(navigator.vendor);
        if (window.location.hash && chrome) {
            setTimeout(function () {
                var hash = window.location.hash;
                window.location.hash = "";
                window.location.hash = hash;
            }, 300);
        }
    }

    if (document.readyState === "loading") {
        // Loading hasn't finished yet
        document.addEventListener("DOMContentLoaded", fixes_chrome_anchors);
    } else {
        // `DOMContentLoaded` has already fired
        fixes_chrome_anchors();
    }
</script>

<!-- customize line 38-50 swap next previous-->
                    
                        <a href="/jekylls/2023-12-26-code_generation.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page: Testing | System Testing">
                            <i class="fa fa-angle-left"></i>
                        </a>
                    

                    
                        <a href="/jekyll/2023-12-20-system_testing.html" class="navigation navigation-next navigation-unique" aria-label="Next page: Compiler | Code Generation (Unfinished)">
                            <i class="fa fa-angle-right"></i>
                        </a>
                    
                </div>
            </div>

            <script>
            var gitbook = gitbook || [];
            gitbook.push(function() {
                gitbook.page.hasChanged({
    "page": {
        "title": "Introduction",
        "level": "1.1",
        "depth": 1,
        
        "next": {
            "title": "Compiler | Code Generation (Unfinished)",
            "level": "1.2",
            "depth": 1,
            "path": "_posts/2023/2023-12-26-code_generation.md",
            "ref": "_posts/2023/2023-12-26-code_generation.md",
            "articles": []
        },
        
        "dir": "ltr"
    },    "config": {
        "plugins": ["fontsettings", "highlight", "livereload", "lunr", "search", "sharing", "theme-default", "livereload"],
        "styles": {
            "ebook": "styles/ebook.css",
            "epub": "styles/epub.css",
            "mobi": "styles/mobi.css",
            "pdf": "styles/pdf.css",
            "print": "styles/print.css",
            "website": "styles/website.css"
        },
        "pluginsConfig": {
            "expandable-chapter-small2": {
                "articlesExpand": true,
            },
            "fontsettings": {
                "family": "sans",
                "size": 1,
                "theme": "white"
            },
            "highlight": {},
            "livereload": {},
            "lunr": {
                "ignoreSpecialCharacters": false,
                "maxIndexSize": 1000000
            },
            "search": {},            "sharing": {
                "facebook": false,

                "google": false,

                "github": true,
              
                "github_link": "https://github.com",
              

                "telegram": false,
                "telegram_link": "https://t.me",

                "instapaper": false,

                "twitter": false,
              

                "vk": false,

                "weibo": false,

                // "all": ["facebook", "google", "twitter", "weibo", "instapaper", "github", "telegram"]
            },
"theme-default": {
                "showLevel": false,
                "styles": {
                    "ebook": "styles/ebook.css",
                    "epub": "styles/epub.css",
                    "mobi": "styles/mobi.css",
                    "pdf": "styles/pdf.css",
                    "print": "styles/print.css",
                    "website": "styles/website.css"
                }
            },
        },
        "theme": "default",
        "author": "Tao He",
        "pdf": {
            "pageNumbers": true,
            "fontSize": 12,
            "fontFamily": "Arial",
            "paperSize": "a4",
            "chapterMark": "pagebreak",
            "pageBreaksBefore": "/",
            "margin": {
                "right": 62,
                "left": 62,
                "top": 56,
                "bottom": 56
            }
        },
        "structure": {
            "langs": "LANGS.md",
            "readme": "Home.md",
        },
        "variables": {},
        "title": "Home",
        "language": "en",
        "gitbook": "*"
    },
    "file": {
        "path": "_posts/2023/2023-12-23-virtual_memory.md",
        "mtime": "2023-12-23 00:00:00 +0000",
        "type": "markdown"
    },
    "gitbook": {
        "version": "3.2.3",
        "time": "2025-09-16 12:46:29 +0000"
    },
    "basePath": "",
    "book": {
        "language": ""
    }
});
            });
            </script>
        </div><script src="/assets/gitbook/gitbook.js"></script>
<script src="/assets/gitbook/theme.js"></script>

<script src="/assets/gitbook/gitbook-plugin-back-to-top-button/plugin.js"></script>
<script src="/assets/gitbook/gitbook-plugin-copy-code-button/toggle.js"></script>
<script src="/assets/gitbook/gitbook-plugin-expandable-chapters-small2/expandable-chapters-small.js"></script>
<script src="/assets/gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
<script src="/assets/gitbook/gitbook-plugin-search-pro/jquery.mark.min.js"></script>
<script src="/assets/gitbook/gitbook-plugin-search-pro/search.js"></script>
<script src="/assets/gitbook/gitbook-plugin-sharing/buttons.js"></script>
<script src="/assets/gitbook/gitbook-plugin-splitter/splitter.js"></script>

<!--
<script src="../gitbook/gitbook-plugin-lunr/lunr.min.js"></script>
<script src="../gitbook/gitbook-plugin-lunr/search-lunr.js"></script>
<script src="../gitbook/gitbook-plugin-search/search-engine.js"></script>
<script src="../gitbook/gitbook-plugin-search/search.js"></script>
-->

</body>
</html>